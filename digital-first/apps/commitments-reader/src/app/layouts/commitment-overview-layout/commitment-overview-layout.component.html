<mdc-linear-progress [open]="isBusy$ | async"></mdc-linear-progress>
<div class="layout-page">
  <section>
    <div
      class="app-layout__row--no-wrap"
      style="height: calc(100vh - 112px) !important; overflow: hidden;"
    >
      <digital-first-metadata-refiner
        style="overflow-y:auto"
        [searchText]="textRefiner$ | async"
        [refinerGroups]="refinerGroups"
        (onSearchCriteriaChanged)="handleTextRefinerChanged($event)"
        (onClear)="handleClearRefiners($event)"
        (onRefinerGroupSelected)="handleRefinerGroupSelected($event)"
        (onRefinerSelected)="handleRefinerSelected($event)"
      ></digital-first-metadata-refiner>
      <div class="overview-outlet">
        <section>
          <mdc-drawer #drawer drawer="modal" class="electrate-drawer">
            <mdc-drawer-header>
              <h3 mdcDrawerTitle>Refine by electrates</h3>
            </mdc-drawer-header>

            <mdc-drawer-content>
              <mdc-list-group>
                <div *ngFor="let state of refinerGroupWithDrawer?.children">
                  <label>
                    <mdc-icon style="vertical-align: middle">{{
                      state.selected
                        ? 'check_box_outline_blank'
                        : 'indeterminate_check_box'
                    }}</mdc-icon>
                    {{ state.title }}
                  </label>
                  <mdc-list [verticalOrientation]="true" dense>
                    <mdc-list-item
                      class="refiner"
                      *ngFor="let electorate of state.children; let i = index"
                    >
                      <mdc-icon
                        >check_box{{
                          i / 2 == 0 ? '' : '_outline_blank'
                        }}</mdc-icon
                      >
                      {{ electorate.title }}
                    </mdc-list-item>
                  </mdc-list>
                </div>
              </mdc-list-group>
            </mdc-drawer-content>
          </mdc-drawer>
          <mdc-tab-bar [activeTabIndex]="activeTab" useAutomaticActivation>
            <mdc-tab-scroller>
              <mdc-tab
                *ngFor="let tab of tabs"
                [label]="tab.label"
                [icon]="tab.icon"
                [routerLink]="tab.link"
              ></mdc-tab>
            </mdc-tab-scroller>
          </mdc-tab-bar>
          <div class="app-layout__row--no-wrap">
            <router-outlet></router-outlet>
          </div>
        </section>
      </div>
    </div>
  </section>
</div>
