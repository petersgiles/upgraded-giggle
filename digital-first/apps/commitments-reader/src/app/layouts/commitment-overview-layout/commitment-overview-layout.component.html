<mdc-linear-progress [open]="isBusy$ | async"></mdc-linear-progress>
<div class="layout-page">
  <section>
    <div
      class="app-layout__row--no-wrap"
      style="height: calc(100vh - 112px) !important; overflow: hidden;"
    >
      <digital-first-metadata-refiner
        style="overflow-y:auto"
        [searchText]="textRefiner$ | async"
        [refinerGroups]="refinerGroups"
        (onSearchCriteriaChanged)="handleTextRefinerChanged($event)"
        (onClear)="handleClearRefiners($event)"
        (onRefinerGroupSelected)="handleRefinerGroupSelected($event)"
        (onRefinerSelected)="handleRefinerSelected($event)"
        (onSlideOutGroupSelected) = "handleSlideOutGroupSelected($event)"
      ></digital-first-metadata-refiner>
      <div class="overview-outlet">
        <section>
          <mdc-drawer #drawer drawer="modal" class="electrate-drawer">
            <mdc-drawer-header>
              <h3 mdcDrawerTitle>Refine by electorates</h3>
            </mdc-drawer-header>

            <mdc-drawer-content *ngIf="refinerGroupWithDrawer">
              <ng-select class="custom"
                [items]="electrates"
                [multiple]="true"
                bindLabel="title"
                groupBy ="state"
                [selectableGroup]="true"
                [selectableGroupAsModel]="false"
                [closeOnSelect]="false"
                bindValue="id"
                [(ngModel)]="selectedRefiners">
                <ng-template ng-optgroup-tmp let-item="item" let-item$="item$" let-index="index">
                    <input id="item-{{index}}" type="checkbox" [ngModel]="item$.selected"/> {{item.state | uppercase}}
                </ng-template>
                <ng-template ng-option-tmp let-item="item" let-item$="item$" let-index="index">
                    <input id="item-{{index}}" type="checkbox" [ngModel]="item$.selected"/> {{item.title}}
                </ng-template>
            </ng-select>
            </mdc-drawer-content>
          </mdc-drawer> 
          <mdc-tab-bar [activeTabIndex]="activeTab" useAutomaticActivation>
            <mdc-tab-scroller>
              <mdc-tab
                *ngFor="let tab of tabs"
                [label]="tab.label"
                [icon]="tab.icon"
                [routerLink]="tab.link"
              ></mdc-tab>
            </mdc-tab-scroller>
          </mdc-tab-bar>
          <div class="app-layout__row--no-wrap">
            <router-outlet></router-outlet>
          </div>
        </section>
      </div>
    </div>
  </section>
</div>
