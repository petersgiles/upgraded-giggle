<div class="indent">
  <ng-container *ngIf="commitment$ | async as commitment">
    <h1>{{ commitment?.title }}</h1>

    <p>
      Responsible Portfolio: <strong>{{ commitment.portfolio }}</strong
      >.
    </p>

    <p>
      Announced on
      <strong>{{ commitment.date | amDateFormat: 'LL' }}</strong>
      <span *ngIf="commitment.announcedBy">
        by <strong>{{ commitment.announcedBy }}</strong></span
      >.
    </p>

    <p>
      This is
      <strong>{{ getIndefiniteArticle(commitment.commitmentTyp) }}</strong>
      commitment
      <ng-container *ngIf="!commitment?.cost">
        with <strong>no</strong> specified party funding</ng-container
      >
      <ng-container *ngIf="commitment.cost"
        >that the party announced requires funding of
        <strong>{{ commitment.cost }}</strong></ng-container
      >. It was announced via
      <strong>{{ getIndefiniteArticle(commitment.announcementType) }}</strong
      >.
    </p>

    <p *ngIf="commitment.electorates as electorates">
      Delivery Location<span *ngIf="electorates?.length > 1">s</span>:
      <ng-container
        *ngFor="
          let location of electorates;
          index as index;
          last as last;
          first as first
        "
      >
        <ng-container *ngIf="!first">
          <span *ngIf="last"> and </span>
          <span *ngIf="!last">, </span> </ng-container
        ><strong>{{ location?.title }}</strong> </ng-container
      >.
    </p>
    <p>
      Critical date: <strong> {{ commitment.criticalDate }}</strong
      >.
    </p>

    <ng-container *ngIf="commitment.description">
      <hr />
      <div [innerHtml]="commitment?.description | safeHtml"></div>
    </ng-container>
    <hr />
    <digital-first-commitment-view-guard
      [operation]="getPMCRight(userOperation$ | async)"
    >
      <ng-container operation-type="read"><p>PMC Handling Advice: <strong>{{ currentPMCHandling$ | async }}</strong>.</p></ng-container>

      <ng-container operation-type="write">
        <form [formGroup]="pmcHandlingAdviceForm" id="pmcHandlingAdviceForm">
          <mdc-select
            #enhanced
            placeholder="PMC Handling Advice"
            formControlName="pmcHandlingAdvice"
            (selectionChange)="onPMCChange($event)"
          >
            <option
              *ngFor="let advice of handlingAdvices$ | async"
              [value]="advice.value"
              [selected]="advice.value === commitment.pmcHandlingAdvice"
              >{{ advice.label }}
            </option>
          </mdc-select>
        </form>
      </ng-container>
    </digital-first-commitment-view-guard>

    <digital-first-commitment-view-guard
      [operation]="getPMORight(userOperation$ | async)"
    >
      <ng-container operation-type="read"><p>PMO Handling Advice: <strong>{{ currentPMOHandling$ | async }}</strong>.</p></ng-container>

      <ng-container operation-type="write">
        <form [formGroup]="pmoHandlingAdviceForm" id="pmoHandlingAdviceForm">
          <mdc-select
            #enhanced
            placeholder="PMO Handling Advice"
            formControlName="pmoHandlingAdvice"
            (selectionChange)="onPMOChange($event)"
          >
            <option
              *ngFor="let advice of handlingAdvices$ | async"
              [value]="advice.value"
              [selected]="advice.value === commitment.pmoHandlingAdvice"
              >{{ advice.label }}</option
            >
          </mdc-select>
        </form>
      </ng-container>
    </digital-first-commitment-view-guard>

    <div *ngIf="commitment.relatedLinks">
      <h1>Related Links</h1>

      <mdc-list>
        <mdc-list-item *ngFor="let link of commitment.relatedLinks">
          <a [href]="link.url" target="_blank">{{ link.title }}</a>
        </mdc-list-item>
      </mdc-list>
    </div>
  </ng-container>
</div>

<ng-template #loading>
  Loading...
</ng-template>
