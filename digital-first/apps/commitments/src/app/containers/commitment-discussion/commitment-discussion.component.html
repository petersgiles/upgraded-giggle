<digital-first-commitment-view-guard
  [operation]="getRight(userOperation$ | async)"
>
<ng-container operation-type="read">
    <digital-first-page-title *ngIf="commitment" title="Discussion" (onTitleClicked)="handleChangeExpanded(!expanded)">
        <digital-first-date-format-button *ngIf="expanded" [timeFormat]='timeFormat'
          (onChangeDateFormat)="handleChangeDateFormat($event)"></digital-first-date-format-button>
        <digital-first-expand-collapse-button [expanded]='expanded' (onChangeExpanded)="handleChangeExpanded(!expanded)"></digital-first-expand-collapse-button>
      </digital-first-page-title>

      <df-discussion *ngIf="commitment && expanded" [comments]="discussion$ | async"
        [hostId]="commitment" [activeComment]="activeComment" [timeFormat]="timeFormat" [readOnly]="true"
        (onDeleteComment)="handleDeleteComment($event)" (onReplyToComment)="handleReplyToComment($event)" (onAddComment)="handleAddComment($event)">
      </df-discussion>
</ng-container>

<ng-container operation-type="write">

    <digital-first-page-title *ngIf="commitment" title="Discussion" (onTitleClicked)="handleChangeExpanded(!expanded)">
        <digital-first-date-format-button *ngIf="expanded" [timeFormat]='timeFormat'
          (onChangeDateFormat)="handleChangeDateFormat($event)"></digital-first-date-format-button>
        <digital-first-expand-collapse-button [expanded]='expanded' (onChangeExpanded)="handleChangeExpanded(!expanded)"></digital-first-expand-collapse-button>
      </digital-first-page-title>

      <df-discussion *ngIf="commitment && expanded" [comments]="discussion$ | async"
        [hostId]="commitment" [activeComment]="activeComment" [timeFormat]="timeFormat" [readOnly]="false"
        (onDeleteComment)="handleDeleteComment($event)" (onReplyToComment)="handleReplyToComment($event)" (onAddComment)="handleAddComment($event)">
      </df-discussion>
  </ng-container>
</digital-first-commitment-view-guard>
