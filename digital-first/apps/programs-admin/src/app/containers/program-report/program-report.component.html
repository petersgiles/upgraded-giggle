<div *ngIf="report; else loading" class="app-page">
  <section>
    <df-expander-panel
      title="Report - {{ report.name }}"
      [expanded]="true"
      [expandable]="false"
    >
      <ng-container panel-buttons>
        <df-button
          icon="edit"
          title="Edit"
          (onClick)="handleEditReport(report)"
        ></df-button>
      </ng-container>
    </df-expander-panel>

    <div class="programsadmin-layout__row">
      <dl>
        <dt>
          Notes:
        </dt>
        <dd *ngIf="report.notes; else elseBlock">{{ report.notes }}</dd>
        <ng-template #elseBlock>
          <dd>No notes were provided for this report</dd>
        </ng-template>
      </dl>
    </div>

    <digital-first-permission
      (onAddGroup)="handleOpenAddGroupDialog($event)"
      (onDeleteClicked)="handleGroupPermissionDeleteClicked($event)"
      (onGroupClicked)="handleGroupPermissionGroupClicked($event)"
      (onPermissionClicked)="handleGroupPermissionChangeClicked($event)"
      [artifactId]="reportId"
      [rows]="permissionRows"
      [noDataMessage]="noDataMessage"
    ></digital-first-permission>

    <div *ngIf="latestVersion">
      <df-expander-panel
        title="Active Report Version"
        [expanded]="true"
        [expandable]="false"
      >
        <ng-container panel-buttons>
          <df-button
            icon="edit"
            title="Edit"
            (onClick)="handleEditReportVersion(latestVersion.id)"
          ></df-button>
        </ng-container>
      </df-expander-panel>

      <div class="programsadmin-layout__row">
        <p>Data date: {{ latestVersion.dataDate }}</p>
        <p *ngIf="latestVersion.notes; else elseBlock">
          Notes: {{ latestVersion.notes }}
        </p>
        <ng-template #elseBlock>
          <p>Notes:</p>
          <p>No notes were provided for this report</p>
        </ng-template>
      </div>
    </div>
  </section>
</div>
<ng-template #loading>
  Loading...
</ng-template>
